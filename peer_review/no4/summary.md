# Title
- An improved adaptive NSGA-II for multi-objective comprehensive
scheduling problem of flexible assembly job shop problem with AGVs
- AGVのFAJSPにおける多目的包括的計画問題のための改良適応型NSGA-II

# Abstruct
- 本論文では、AGVハンドリングによるフレキシブル組立ジョブショップ(FAJSP-AGV)における包括的なスケジューリング問題を扱う。さらに、機械間のハンドリング時間を考慮し、工程ハンドリングのためにマルチAGVシステムを導入する。最適化目標には、 メークスパン、機械エネルギー消費、AGV作業時間の最小化が含まれる 。これらの目的に基づいて、FAJSP-AGVのための数学的モデルが確立される。この問題を解決するために、改良型適応NSGA-IIアルゴリズム(IA-NSGA-II)が導入され、組立制約を満たすために工程制約行列の符号化が利用される。突然変異操作は、遺伝操作中の染色体の合法性を保証するために、プロセス制約行列に適応される。さらに、可変近傍探索(VNS)を取り入れて探索空間を広げ、高品質な解の生成を強化する。シミュレーション実験により、提案アルゴリズムの有効性を検証する。さらに、動的事象が元のスケジューリング方式に与える影響を考慮し、本論文では動的再スケジューリングに研究を拡張し、安定性を確保しつつ、メークスパンを最小化することを目指す。シミュレーション実験により、動的再スケジューリング戦略の実現可能性を検証する。

# Chapter 1: 導入
- Flexible Job Shop Scheduling Problem (FJSP), as an extension of the Job Shop Scheduling Problem (JSP), enhances the flexibility of machine selection, thereby improving the flexibility of job processing. This makes the scheduling model more aligned with actual production needs, rendering it a more challenging NP-hard problem compared to JSP [1]. The Flexible Assembly Job Shop Scheduling Problem (FAJSP) extends FJSP by considering the assembly constraints of product components. Optimizing the coordination between production processes and assembly processes is crucial in addressing the Flexible Assembly Shop Scheduling Problem. 
- フレキシブル・ジョブショップ・スケジューリング問題(FJSP)は、ジョブショップ・スケジューリング問題(JSP)の拡張として、機械選択の柔軟性を高め、ジョブ処理の柔軟性を向上させる。これにより、スケジューリングモデルは実際の生産ニーズにより合致したものとなり、JSPと比較してより困難なNP困難問題となる[1]。フレキシブル組立ジョブショップスケジューリング問題(FAJSP)は、製品部品の組立制約を考慮することによりFJSPを拡張したものである。生産工程と組立工程の間の調整を最適化することは、フレキシブル組立工程スケジューリング問題に取り組む上で極めて重要である。

- In recent years, many researchers have studied extensions of the FAJSP to make it more like a real production system and have made great progress. Li Zihui et al. [2] proposed a hybrid distribution estimation algorithm to solve the Flexible Assembly Flow Shop Scheduling Problem with different processes, yielding promising results. Yang Xiaojia et al. [3] established a mathematical model for flexible assembly shop problem with stochastic disturbances, adopting dynamic scheduling strategies. They designed a genetic algorithm-based periodic rolling scheduling method to solve the model, demonstrating the superiority of the algorithm through extensive experiments. Wu et al. [4] conducted research on distributed flexible assembly shop, aiming to minimize both delay time and total cost through cooperative optimization. They proposed an improved differential evolution simulated annealing algorithm to solve the model. Zhang et al. [5] focused on preventive maintenance in assembly line scheduling, using completion time and maintenance time as optimization objectives. They proposed two heuristic algorithms and combined them with iterative greedy algorithms to solve the problem, validating the effectiveness of the algorithms. Ren et al. [6] proposed a heuristic algorithm combining particle swarm optimization and genetic algorithm to jointly optimize the production efficiency and energy consumption of flexible assembly shop.
- 近年、多くの研究者がFAJSPをより実際の生産システムに近づけるための拡張を研究し、大きな進歩を遂げている。

- While most studies consider the processing of jobs on machines, they often overlook the transportation of jobs between machines. With modern manufacturing transitioning towards intelligence, the movement of jobs between machines is predominantly handled by Automatic Guided Vehicles (AGVs). AGVs play a crucial role in the integrated scheduling and coordinated optimization of processing equipment and transportation resources in smart manufacturing systems. Hence, the integration of AGV scheduling with the FAJSP holds significant practical value in enhancing the efficiency of intelligent manufacturing systems.
- 多くの研究は、機械上でのジョブの処理を考慮する一方で、機械間のジョブの輸送を見落としていることが多い。インテリジェント化が進む現代の製造業では、機械間のジョブの移動は主に無人搬送車（AGV）によって処理される。AGVは、スマート製造システムにおける処理装置と輸送リソースの統合スケジューリングと協調最適化において、重要な役割を果たす。従って、AGVスケジューリングとFAJSPの統合は、インテリジェント製造システムの効率を高める上で重要な実用的価値を持つ。

- Currently, there is limited research on the FAJSP with the involvement of AGVs, and there is no established benchmark dataset available. Most studies have focused on FJSP with AGV scheduling, assembly line scheduling, and distributed flow shop scheduling. The research objectives mainly revolve around four aspects: machine allocation, operation scheduling, AGV scheduling and allocation, and AGV path planning.
- 現在、AGVを含むFAJSPに関する研究は限られており、確立されたベンチマークデータセットもない。ほとんどの研究は、AGVスケジューリング、組立ラインスケジューリング、分散フローショップスケジューリングを含むFJSPに焦点を当てている。研究目的は主に、機械割当て、作業スケジューリング、AGVスケジューリングと割当て、AGV経路計画という4つの側面に集中している。

- Rahman et al. [7] proposed a heuristic and meta-heuristic combined optimization approach for the assembly line balancing and AGV scheduling problem in the context of Industry 4.0. Through computational experiments, this method effectively reduced the cycle time and total delay of the assembly system, providing empirical support for the efficiency optimization of intelligent assembly systems.
- Rahmanら[7]は、インダストリー4.0の文脈における組立ラインのバランシングとAGVスケジューリング問題に対して、ヒューリスティックとメタヒューリスティックを組み合わせた最適化アプローチを提案した。計算実験を通じて、この手法は、組立システムのサイクルタイムと総遅延を効果的に削減し、インテリジェント組立システムの効率最適化の実証的な裏付けを提供した。

- In the research on AGV scheduling in unbuffered assembly lines, Wang et al. [8] proposed a forward-looking scheduling strategy based on genetic algorithms by establishing a Petri net model. They effectively addressed the issue of processing sequence conflicts. Through simulation and robotic experiments, they demonstrated its effectiveness in reducing total processing time and improving the efficiency of AGVs and machines.
- バッファリングされていない組立ラインにおける無人搬送車のスケジューリングに関する研究において、Wangら[8]は、ペトリネットモデルを確立することにより、遺伝的アルゴリズムに基づく将来を見据えたスケジューリング戦略を提案した。彼らは、処理順序の競合の問題に効果的に対処した。シミュレーションとロボット実験を通して、彼らは、総処理時間を短縮し、AGVと機械の効率を向上させる有効性を実証した。

- Karimi et al. [9] aimed to minimize the maximum completion time and established two mixed-integer linear programming models based on sequences and positions for the FJSP considering transportation time. Experimental results indicated the superiority of the sequence-based model. Dai et al. [10] studied the FJSP considering transportation time with objectives of minimizing the maximum completion time and total energy consumption. They transformed the bi-objective problem into a single-objective one using a weighted sum method and designed an improved genetic algorithm for solving it, revealing conflicting relationships between the two objectives. Peng et al. [11] investigated the FJSP with transportation time constraints, aiming to minimize processing energy consumption. They proposed a hybrid discrete multiobjective imperialist competitive algorithm for solving the problem and validated the effectiveness of the proposed algorithm through comparisons with other algorithms. Zhou et al. [12] conducted research on the FJSP considering crane transportation and devised a hybrid algorithm based on decomposed multi-objective evolutionary algorithm and particle swarm optimization to minimize the makespan and total energy consumption. Homayouni et al. [13] studied the FJSP considering transportation time with the objective of minimizing the makespan. They designed an operation based multi-start biased random key genetic algorithm to solve the problem, demonstrating its effectiveness in addressing similar workshop scheduling problem. Yan et al. [14] established a model for finite transportation conditions in flexible job shop environments and designed an improved genetic algorithm for solving it by discussing the constraints imposed by finite transportation conditions. 
- Karimiら[9]は、最大完了時間を最小化することを目的とし、輸送時間を考慮したFJSPに対して、シーケンスと位置に基づく2つの混合整数線形計画モデルを確立した。実験の結果、シーケンスに基づくモデルの優位性が示された。Daiら[10]は、輸送時間を考慮したFJSPについて、最大完了時間と総エネルギー消費量の最小化を目的として研究した。彼らは、重み付き和法を用いて両目的問題を単一目的問題に変換し、それを解くための改良された遺伝的アルゴリズムを設計し、2つの目的間の相反する関係を明らかにした。Pengら[11]は、処理エネルギー消費を最小化することを目的とし、輸送時間制約のあるFJSPを研究した。彼らはこの問題を解くためのハイブリッド離散多目的帝国主義競争アルゴリズムを提案し、他のアルゴリズムとの比較を通じて提案アルゴリズムの有効性を検証した。Zhouら[12]は、クレーン輸送を考慮したFJSPの研究を行い、メークスパンと総エネルギー消費を最小化するために、分解多目的進化アルゴリズムと粒子群最適化に基づくハイブリッドアルゴリズムを考案した。Homayouniら[13]は、メークスパンを最小化する目的で、輸送時間を考慮したFJSPを研究した。Homayouniら[13]は、輸送時間を考慮し、メークスパンを最小化することを目的としたFJSPを研究している。Yanら[14]は、フレキシブル・ジョブショップ環境における有限輸送条件のモデルを確立し、有限輸送条件によって課される制約を議論することによって、この問題を解くための改良された遺伝的アルゴリズムを設計した。


- The job shop scheduling problems are all static scheduling problems, without considering various uncertainties in actual production. The reality is that most situations faced by enterprises involve more complex dynamic scheduling problems, where there may be machine breakdowns, urgent rush orders, early deliveries, and other unexpected issues. Cao et al. [15] proposed an adaptive heterogeneous earliest finish time algorithm to address the objective of minimizing the makespan in the FJSP with arrival orders. Ozturk et al. [16] combined genetic programming with gene expression programming to propose two methods for the DFJSP. Hu et al. [17] introduced a novel Petri net-based dynamic scheduling approach, utilizing deep Q-network (DQN) and graph convolutional networks to solve dynamic scheduling problems in flexible manufacturing systems. We compare the existing papers with our work in the following Table 1.
- ジョブショップのスケジューリング問題は、すべて静的なスケジューリング問題であり、実際の生産における様々な不確実性を考慮しない。現実には、企業が直面するほとんどの状況は、より複雑な動的スケジューリング問題を含んでおり、機械の故障、急ぎの注文、早期の納品、その他の予期せぬ問題が発生する可能性がある。Caoら[15]は、到着オーダを伴うFJSPにおけるメークスパンを最小化するという目的に対処するために、適応的異種最早終了時間アルゴリズムを提案した。Ozturkら[16]は遺伝的プログラミングと遺伝子発現プログラミングを組み合わせ、DFJSPのための2つの手法を提案した。Huら[17]は、フレキシブル製造システムにおける動的スケジューリング問題を解決するために、ディープQネットワーク（DQN）とグラフ畳み込みネットワークを利用した、新しいペトリネットベースの動的スケジューリングアプローチを紹介した。以下の表1で既存の論文と我々の研究を比較する。

- In this study, a model of FAJSP with AGVs (FAJSP-AGVs) was established, and an improved adaptive NSGA-II [18] algorithm was proposed to optimize efficiency and green indicators. The main contributions of this paper include the following aspects: (1) A mathematical model for FAJSP-AGVs was established, with three objectives: minimizing the makespan, total machine energy consumption, and AGV working time. (2) An improved adaptive NSGA-II algorithm was proposed to optimize FAJSP-AGVs. (3) Specialized encoding methods, adaptive crossover, and adaptive mutation operators were designed. (4) A variable neighborhood search strategy was integrated to avoid local optima. (5) Practical scenarios were considered, and a dynamic scheduling strategy for machine failures was proposed and validated.
- 本研究では、AGVを用いたFAJSP（FAJSP-AGV）のモデルを確立し、改良型適応NSGA-II [18]アルゴリズムを提案した。(1)FAJSP-AGVの数学モデルを確立し、3つの目的(メークスパンの最小化、機械エネルギー消費量の最小化、AGV作業時間の最小化)を設定した。(2) FAJSP-AGVを最適化するための改良型適応NSGA-IIアルゴリズムを提案した。(3) 特殊な符号化法、適応的クロスオーバー、適応的ミューテーション演算子を設計した。(4)局所最適を回避するために可変近傍探索戦略を統合した。(5)実用的なシナリオを考慮し、機械故障に対する動的スケジューリング戦略を提案し、検証した。

- ●表1
問題(メイクスパン、エネルギー消費、AGV稼働時間)と解き方の両方が先行研究と違う。
この辺りが新規性だと主張したいと推察するが、本研究の有用性、創造性はどこにあるのか。
解き方も、NSGA-IIの他に、可変近傍探索を導入するなど、違いがある

# Chapter 2: 問題の説明とモデリング
## Section 2-1: 問題の説明
- Flexible assembly job shop scheduling involves both machining and assembly aspects of the production process, where the final product is assembled from multiple workpieces in strict accordance with the product bill of materials (BOM). Within this, the processing of each part consists of a set of processes with sequential constraints. By combining the processing of the workpieces with the product BOM, a product manufacturing process tree, or process tree for short, is constructed. Fig. 1 shows the process of building a process tree for a single product, with blue circles that represent the process as an assembly process, white circles that represent the machining process, and black dashed boxes that represent the different workpieces. While the number inside the circle represents the process number, the number outside the dashed box represents the workpiece number. Therefore, as shown in the figure, the product consists of 6 workpieces which are machined and assembled, and it contains 10 processes in total.

## Section 2-2: モデリング
- We establish a FAJSP-AGVs model with minimizing the makespan, total machine energy consumption, and total AGV working time. The model is based on the following assumptions:

# Chapter 3: 設計された改良適応型NSGA-II
- The NSGA-II algorithm is a classic multi-objective optimization algorithm. However, it cannot be directly applied to this problem and has some drawbacks. For instance, in solving FAJSP-AGVs, the algorithm may generate infeasible solutions during the initialization of the population and genetic operations due to assembly constraints. Additionally, it is prone to getting trapped in local optima during the iterative process. Therefore, to effectively address the FAJSP-AGVs, an improved adaptive NSGA-II algorithm (IA-NSGA-II) is proposed. (1) The algorithm's encoding, crossover, and mutation methods are tailored to the problem's characteristics. (2) Using improved adaptive crossover and mutation probabilities to further assist the algorithm in improving convergence. (3) A variable neighborhood search method is incorporated into the algorithm to further expand the solution space, thereby avoiding getting stuck in local optima.

## Section 3-1: Encoding Method

## Section 3-2: Genetic operations

## Section 3-3: Variable Neighborhood Search

## Section 3-4: Rescheduling strategy

# Chapter 4: Experimental Results
- To evaluate the feasibility and effectiveness of the proposed algorithm, several experiments were conducted, including selfvalidation and comparative analysis with existing algorithms. The experiments aimed to evaluate the algorithm's ability to generate high-quality schedules for flexible assembly job shop.

## Section 4-1: Parameter settings
- Currently, there are many standard benchmark instances available for traditional JSP and FJSP. However, no established standard benchmark instance library has been created or fully standardized for FAJSP. To verify the feasibility of the proposed method, existing benchmark instances from the reference Wu et al. [22] are selected for testing. For ease of presentation and clarity, the improved adaptive NSGA-II scheduling method introduced in this paper is referred to as "IA-NSGA-II", while the original scheduling method proposed in the literature is referred to as "INSGA-II." The parameters related to the algorithm are set as follows: the initial population size is 100, the number of genetic generations is 100, and the implementation is carried out using the MATLAB programming language. For each instance, the solution is obtained independently through 10 runs to ensure reliability and consistency.
- 現在、従来のJSPとFJSPには多くの標準的なベンチマーク・インスタンスが存在する。しかし、FAJSPについては、確立された標準ベンチマーク・インスタンス・ライブラリは作成されておらず、完全に標準化されていない。提案手法の実現可能性を検証するために、参考文献であるWuら[22]の既存のベンチマークインスタンスをテスト用に選択した。本論文で紹介する改良型適応型NSGA-IIスケジューリング手法を「IA-NSGA-II」と呼び、文献で提案されているオリジナルのスケジューリング手法を「INSGA-II」と呼ぶ。アルゴリズムに関するパラメータは、初期集団サイズを100、遺伝的世代数を100とし、プログラミング言語MATLABを用いて実装する。各インスタンスについて、信頼性と一貫性を確保するために、10回の実行によって解を独立に求める。
- Then, in the context of FAJSP-AGVs, instances cited from Wu et al. [27] are chosen for testing. The scheduling method proposed in the literature is referred to as "IGA." The obtained results will be compared with those obtained using both IGA and NSGA-II. Algorithm-related parameters are set as follows: the initial population size is 100, the number of genetic generations is 100, and the implementation is done using the MATLAB programming language. For each instance, the solution is independently obtained through 20 runs.
- 次に、FAJSP-AGVの文脈で、Wuら[27]から引用されたインスタンスをテスト用に選択する。この文献で提案されているスケジューリング法を「IGA」と呼ぶ。得られた結果は、IGAとNSGA-IIの両方を用いて得られた結果と比較する。アルゴリズム関連のパラメータは以下のように設定される：初期集団サイズは100、遺伝的世代数は100、実装はMATLABプログラミング言語を用いて行われる。各インスタンスについて、20回の実行により解が独立に得られる。

## Section 4-2: Experiment 1


## Section 4-3: Experiment 2
- ●図12
100個体なのに、IA-NSGA-IIとINSGA-IIの解は10個以下なのはなぜか。

## Section 4-4: Experiment 3
- When a machine fails during production, the machine cannot process any processes until the repair is completed, and scheduling tasks for this machine must wait until the repair is finished. In this experiment, Machine 1 is set to fail during processing, with failure times set to 5 unit times, 10 unit times, 15 unit times, and 20 unit times. Upon failure, complete rescheduling of the remaining processes is performed based on the duration of the failure. Based on the 20 scheduling results obtained from Experiment 2, three sets of results were randomly selected for rescheduling experiments to test the stability of IA-NSGA-II in dynamic scheduling. The objective metric used is the delay degree DE as indicated in Equation (15), where both μ1 and μ2 are set to 0.5.
- 生産中に機械が故障した場合、その機械は修理が完了するまで一切の処理を行うことができず、この機械のスケジューリングタスクは修理が完了するまで待たなければならない。この実験では、機械1は処理中に故障するように設定され、故障時間は5単位時間、10単位時間、15単位時間、20単位時間に設定される。故障が発生すると、故障時間に基づいて残りの処理の完全な再スケジューリングが実行される。実験2で得られた20のスケジューリング結果をもとに、3つの結果をランダムに選択し、動的スケジューリングにおけるIA-NSGA-IIの安定性を検証するための再スケジューリング実験を行った。使用した目的指標は、式(15)で示される遅延度DEであり、μ1とμ2はともに0.5に設定されている。
  
# Chapter 5: Conclusions
- This paper focuses on addressing the complex scheduling challenges in flexible assembly job shops with AGVs to improve the efficiency of workshop. First, a mathematical model for the FAJSP-AGVs was established, with the objectives set to minimize makespan, total machine energy consumption, and AGV working time. Then, an improved adaptive NSGA-II algorithm was proposed. The encoding was designed according to the problem characteristics. For the process sequence part, a process constraint matrix-based encoding method was proposed, effectively avoiding infeasible solutions due to assembly constraints when generating the initial population. Similarly, improved crossover and mutation operators were proposed to ensure the legality of solutions obtained during genetic operations. A variable neighborhood search was also incorporated to further expand the solution space and effectively avoid the algorithm getting trapped in local optima. Finally, feasibility and effectiveness comparison experiments were conducted using test cases proposed in the literatures. The stability of the proposed method in dealing with dynamic scheduling problems was also tested. Experimental results show that the proposed method can effectively solve the FAJSP-AGVs.
- 本論文では、AGVを用いたフレキシブル組立ジョブショップにおける複雑なスケジューリングの課題に取り組み、ワークショップの効率を向上させることに焦点を当てる。まず、FAJSP-AGVの数理モデルを確立し、メークスパン、機械エネルギー消費量、AGV作業時間を最小化することを目的とした。次に、改良型適応NSGA-IIアルゴリズムを提案した。エンコーディングは問題の特徴に従って設計された。工程順序の部分では、工程制約行列に基づく符号化方法が提案され、初期母集団を生成する際に、組立制約による実行不可能な解を効果的に回避した。同様に、遺伝的操作中に得られた解の合法性を保証するために、改良されたクロスオーバーおよびミューテーション演算子が提案された。また、解空間をさらに拡大し、アルゴリズムが局所最適に捕らわれるのを効果的に回避するために、可変近傍探索が組み込まれた。最後に、文献で提案されているテストケースを用いて、実現可能性と有効性の比較実験を行った。また、動的スケジューリング問題に対する提案手法の安定性も検証した。実験の結果、提案手法はFAJSP-AGVを効果的に解くことができることが示された。
- In the future, more scenarios closer to actual production can be considered, such as distributed assembly shop scheduling, conflictfree path planning for AGVs, and dynamic scheduling triggered by other special conditions.
- 将来的には、分散組立工場スケジューリング、AGVのコンフリクトフリー経路計画、その他の特別な条件によって引き起こされる動的スケジューリングなど、より実際の生産に近いシナリオを検討することができる。
